"use strict";(()=>{function o(e){const t=[];var n=0;for(const o of e.entries()){n++;const r=o[1];if(r instanceof File){const s=r.name;const c=r.size;t.push(s+"="+c.toString())}}if(n===0){return Promise.reject(new Error("cannot send empty data"))}return fetch("/",{method:"POST",headers:{"X-Oneshot-Multipart-Content-Lengths":t.join(";")},body:e})}function n(e){if(e.length===0){return Promise.reject(new Error("cannot send empty data"))}return fetch("/",{method:"POST",headers:{"Content-Length":e.length.toString()},body:e})}function e(){console.log("running main");t();r()}function t(){const n=document.getElementById("file-form");if(!n){return}n.addEventListener("submit",e=>{e.preventDefault();e.stopPropagation();const t=new FormData(n);s(o(t))})}function r(){const t=document.getElementById("text-input");const e=document.getElementById("text-form");if(!t||!e){return}e.addEventListener("submit",e=>{e.preventDefault();e.stopPropagation();s(n(t.value))})}function s(e){e.then(e=>{if(e.ok){console.log("Transfer succeeded");document.body.innerHTML="Transfer succeeded"}else{const t="Transfer failed: "+e.status.toString+" "+e.statusText;console.log(t);document.body.innerHTML=t}}).catch(e=>{if(e instanceof Error){if(e.message==="cannot send empty data"){console.log(e.message);alert(e.message);return}}const t="Transfer failed: "+e;console.log(t);document.body.innerHTML=t})}e()})();